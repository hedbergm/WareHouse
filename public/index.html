<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>WareHouse - Part Store</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container">
    <h1>Part Store</h1>
    <p><a class="muted-link" href="/home.html" style="font-size:14px">← Til Hjem / Oversikt</a></p>
  <div id="db-banner" style="display:none;margin:-4px 0 14px 0;padding:10px 14px;border:1px solid #e2e2e2;border-left:4px solid #ff9800;background:#fff8e6;border-radius:6px;font-size:13px;color:#5a4100"></div>

  <!-- Lokasjonsadministrasjon flyttet til locations.html -->

  <section>
    <h2>Registrer del</h2>
    <div class="form-row">
      <div class="col">
        <label>Delenummer</label>
        <input id="part-number" placeholder="TAN-000623">
      </div>
      <div class="col">
        <label>Beskrivelse</label>
        <input id="part-desc" placeholder="Beskrivelse">
      </div>
      <div class="col small">
        <label>Min antall</label>
        <input id="part-min" type="number" placeholder="0">
      </div>
      <div class="col">
        <label>Fast lokasjon</label>
        <select id="part-default-loc">
          <option value="">(Ingen fast lokasjon)</option>
        </select>
      </div>
    </div>
    <div class="actions">
      <button id="add-part" class="btn">Legg til del</button>
      <div id="barcode-preview" class="barcode-box"></div>
    </div>
    <div id="parts" class="list"></div>
  </section>

  <section>
    <h2>Transaksjonslogg</h2>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px">
      <input id="log-filter-part" placeholder="Filter delenummer" style="flex:1;min-width:160px">
      <input id="log-filter-loc" placeholder="Filter lokasjon" style="flex:1;min-width:160px">
      <select id="log-limit" style="width:120px">
        <option value="50">50</option>
        <option value="100">100</option>
        <option value="200">200</option>
        <option value="500">500</option>
      </select>
      <button id="log-refresh" class="btn">Oppdater</button>
    </div>
    <div id="tx-log" class="list" style="max-height:320px;overflow:auto;border:1px solid #eee;border-radius:6px;background:#fff"></div>
  </section>

  <!-- Manuell skann fjernet: all bevegelse skjer via mobil skanning -->

    <script src="/app.js"></script>
    <script>
      fetch('/api/debug/status').then(r=> r.ok ? r.json():null).then(s=>{
        if(!s) return; const b=document.getElementById('db-banner'); if(!b) return;
        if(s.dbMode==='SQLite'){ b.style.display='block'; b.innerHTML='Database-modus: <strong>SQLite (midlertidig)</strong>. Data kan forsvinne ved redeploy. Sett opp Postgres for permanent lagring.'; }
        else { b.style.display='block'; b.style.background='#eef9f1'; b.style.borderLeftColor='#2e7d32'; b.style.color='#1b4d21'; b.innerHTML='Database-modus: <strong>Postgres</strong>. Parts: '+s.parts+' · Lokasjoner: '+s.locations+' · Beholdning rader: '+s.stock; }
      }).catch(()=>{});
    </script>
  </div>
</body>
</html>
